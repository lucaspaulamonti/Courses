SELECT
    PRODU.PROCODIGO,
    UPPER(PRODU.PRODESCRICAO) PRODESCRICAO,
    UPPER(GRUPO1.GR1CODIGO || ' ' || GRUPO1.GR1DESCRICAO) GR1DESCRICAO,
    UPPER(GRUPO2.GR2CODIGO || ' ' || GRUPO2.GR2DESCRICAO) GR2DESCRICAO,
    UPPER(GRUPO3.GR3CODIGO || ' ' || GRUPO3.GR3DESCRICAO) GR3DESCRICAO,
    UPPER(GRUPO4.GR4CODIGO || ' ' || GRUPO4.GR4DESCRICAO) GR4DESCRICAO,
    UPPER(MARCA.MARCODIGO || ' ' || MARCA.MARNOME) MARNOME,
    DECODE(PRODU.PROTIPO,
        'F', 'FABRICADO',
        'P', 'PRODUTO CHAVE',
        'S', 'SURFACAGEM',
        'T', 'TRATAMENTO',
        'M', 'MONTAGEM',
        'C', 'COLORACAO'
    ) PROTIPO,
    CAST(PREMP_INTERNA.PREPCOCUSTO AS DOUBLE PRECISION) PREPCOCUSTO,
    CAST(PREMP_INTERNA.PREPCOVENDA AS DOUBLE PRECISION) PREPCOVENDA,
    CAST(PREMP_INTERNA.PREPCOVENDA2 AS DOUBLE PRECISION) PREPCOVENDA2
FROM
    PRODU
    LEFT JOIN GRUPO1 ON PRODU.GR1CODIGO = GRUPO1.GR1CODIGO
    LEFT JOIN GRUPO2 ON PRODU.GR2CODIGO = GRUPO2.GR2CODIGO
    LEFT JOIN GRUPO3 ON PRODU.GR3CODIGO = GRUPO3.GR3CODIGO
    LEFT JOIN GRUPO4 ON PRODU.GR4CODIGO = GRUPO4.GR4CODIGO
    LEFT JOIN MARCA ON PRODU.MARCODIGO = MARCA.MARCODIGO
    LEFT JOIN PREMP_INTERNA ON PRODU.PROCODIGO = PREMP_INTERNA.PROCODIGO
WHERE
    PRODU.PROTIPO IN ('F', 'P', 'S', 'T', 'M', 'C')
    AND PRODU.PROSITUACAO = 'A'
    AND PRODU.PROTRVVENDA != 'S'
    AND PRODU.TPLCODIGO IS NOT NULL
    AND PREMP_INTERNA.EMPCODIGO = 1
ORDER BY
    PRODU.PRODESCRICAO,
    PRODU.PROCODIGO
;

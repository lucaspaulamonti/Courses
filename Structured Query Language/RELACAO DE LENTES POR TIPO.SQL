SELECT
    TPLENTE.TPLCODIGO,
    TPLENTE.TPLDESCRICAO,
    PRODU.PROCODIGO,
    PRODU.PRODESCRICAO,
    IIF(TPLENTESISEXT.TSENOME = 'E', TPLENTESISEXT.TSECODIGO, NULL) TSECODIGO,
    GRUPO1.GR1DESCRICAO,
    DECODE(TPLENTE.TPLPROCESSO,
        'C', 'CONVENCIONAL',
        'F', 'FREEFORM'
    ) TPLPROCESSO,
    DECODE(TPLENTE.TPLTIPO,
        'S', 'BLOCO VISAO SIMPLES',
        'M', 'BLOCO MULTIFOCAL',
        'B', 'BLOCO BIFOCAL',

        'L', 'LENTE VISAO SIMPLES',
        'A', 'LENTE MULTIFOCAL',
        'C', 'LENTE BIFOCAL',

        'I', 'LENTE INTERMEDIARIA',
        'N', 'NENHUM'
    ) TPLTIPO
FROM PRODU
    INNER JOIN TPLENTE ON PRODU.TPLCODIGO = TPLENTE.TPLCODIGO
    LEFT JOIN GRUPO1 ON PRODU.GR1CODIGO = GRUPO1.GR1CODIGO
    LEFT JOIN TPLENTESISEXT ON TPLENTE.TPLCODIGO = TPLENTESISEXT.TPLCODIGO
WHERE
    PRODU.PROTIPO = 'F'
    AND PRODU.PROSITUACAO = 'A'
    AND PRODU.PROCODIGO NOT LIKE 'PDC%'
    AND PRODU.TPLCODIGO IS NOT NULL
    AND TPLENTE.TPLSIT = 'A'
    AND TPLENTE.TPLCODPRO IS NOT NULL
;

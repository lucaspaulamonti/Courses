SELECT
    RECEB.EMPCODIGO,
    RECEB.RECDTVENCTO,
    RECEB.RECCODIGO,
    RECEB.CLICODIGO,
    RECEB.RECVALORABERTO,
    DECODE(
        RECEB.STCODIGO,
        'A', 'ACORDO', 
        'C', 'CARTORIO', 
        'D', 'PERDASDANOS', 
        'E', 'ESPECIAL',
        'F', 'COBRANCA', 
        'J', 'JURIDICO', 
        'N', 'NORMAL', 
        'P', 'PROTESTO'
    ) STCODIGO
FROM
    RECEB
WHERE
    RECEB.RECDTVENCTO BETWEEN @#DATE#VENCIMENTOINICIAL@ AND @#DATE#VENCIMENTOFINAL@
    AND RECEB.RECSITUACAO = 'N'
    AND RECEB.STCODIGO IN ('N', 'C', 'P', 'A', 'J', 'E', 'D', 'F')
    AND RECEB.RECVALORABERTO > 0.01
ORDER BY
    RECEB.RECCODIGO
;

SELECT
    COUNT(*) QUANTIDADE,
    SUM(RECEB.RECVALORABERTO) RECVALORABERTO,
    DECODE(
        RECEB.STCODIGO,
        'A', 'ACORDO', 
        'C', 'CARTORIO', 
        'D', 'PERDASDANOS', 
        'E', 'ESPECIAL',
        'F', 'COBRANCA', 
        'J', 'JURIDICO', 
        'N', 'NORMAL', 
        'P', 'PROTESTO'
    ) STCODIGO
FROM
    RECEB
WHERE
    RECEB.RECDTVENCTO BETWEEN @#DATE#VENCIMENTOINICIAL@ AND @#DATE#VENCIMENTOFINAL@
    AND RECEB.RECSITUACAO = 'N'
    AND RECEB.STCODIGO IN ('N', 'C', 'P', 'A', 'J', 'E', 'D', 'F')
    AND RECEB.RECVALORABERTO > 0.01
GROUP BY
    STCODIGO
;
